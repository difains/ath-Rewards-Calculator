<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아하 코인 쇼핑 리워드 계산기</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>아하 코인 쇼핑 리워드 계산기</h1>
            <p>프리미엄 구독으로 받는 코인 리워드의 수익성을 계산해보세요!</p>
        </header>

        <div class="calculator-section">
            <form id="coinCalculator">
                <div class="input-group">
                    <label for="date">오늘 날짜:</label>
                    <input type="date" id="date" name="date" required>
                </div>

                <div class="input-group">
                    <label for="coinPrice">코인 현재 시세 (원):</label>
                    <div class="price-input-group">
                        <input type="number" id="coinPrice" name="coinPrice" step="0.01" placeholder="예: 100.50" required>
                        <button type="button" id="fetchPriceBtn" class="fetch-price-btn">📈 시세 불러오기</button>
                    </div>
                    <div id="priceStatus" class="price-status"></div>
                </div>

                <div class="input-group">
                    <label for="productName">상품 이름:</label>
                    <input type="text" id="productName" name="productName" placeholder="구매한 상품명을 입력하세요" required>
                </div>

                <div class="input-group">
                    <label for="coinReward">코인 리워드 개수:</label>
                    <input type="number" id="coinReward" name="coinReward" step="0.00001" placeholder="예: 500.12345" required>
                </div>

                <div class="input-group">
                    <label for="productPrice">상품 가격 (원):</label>
                    <input type="number" id="productPrice" name="productPrice" placeholder="예: 50000" required>
                </div>

                <div class="premium-info">
                    <span class="premium-badge">프리미엄 2배 적용</span>
                </div>

                <div class="button-group">
                    <button type="button" id="addBtn" class="add-btn">추가하기</button>
                    <button type="submit" class="calculate-btn">계산하기</button>
                </div>
            </form>
        </div>

        <div id="results" class="results-section" style="display: none;">
            <div class="results-header">
                <h2>계산 결과</h2>
                <div class="header-buttons">
                    <button id="calculateAllBtn" class="calculate-all-btn">🧮 한 번에 계산하기</button>
                    <button id="exportBtn" class="export-btn">📊 엑셀 다운로드</button>
                </div>
            </div>
            <div class="warning-message">
                ⚠️ 새로고침을 하거나 종료 후 다시 접속하면 데이터는 사라집니다.
            </div>
            
            <div class="grid-container">
                <div class="grid-header">
                    <div class="grid-cell">날짜</div>
                    <div class="grid-cell">상품명</div>
                    <div class="grid-cell">코인리워드</div>
                    <div class="grid-cell">상품가격</div>
                    <div class="grid-cell">코인시세</div>
                    <div class="grid-cell">총받는코인</div>
                    <div class="grid-cell">현재가치</div>
                    <div class="grid-cell">수익률</div>
                    <div class="grid-cell">수익/손실</div>
                    <div class="grid-cell">출금일수(3K)</div>
                    <div class="grid-cell">출금일수(4K)</div>
                    <div class="grid-cell">상승시가치(+10%)</div>
                    <div class="grid-cell">상승시수익률</div>
                    <div class="grid-cell">하락시가치(-10%)</div>
                    <div class="grid-cell">하락시수익률</div>
                    <div class="grid-cell">삭제</div>
                </div>
                <div id="gridBody" class="grid-body">
                    <!-- 데이터 행들이 여기에 추가됩니다 -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
